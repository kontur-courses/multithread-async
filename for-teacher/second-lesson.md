# Второе занятие
## Начало в 12:00 (условно)
## Параллелизм
1. Рассказ для каких задач он нужен (5 минут)
   1. DataParallelism
   2. TaskParallelism
2. Data Parallelism (40 минут) ([подробнее](data-parallelism.md))
   1. PLINQ + Parallel.*
   2. Задачка на пощупать Partioner-ы, Ranged, Chunked и Hash (20 минут)
3. Разбор домашнего задания с прошлой лекции (ReaderWriterLock) - 30 минут
4. Оставшийся материал по Data Parallelism (если остался) - 15 минут
5. TPL - 40 минут (По примерам `TPLSamples`).    
6. ThreadPoolTinyTasksDemo - 5 минут. Покажем, что нельзя запускать кучу маленьких делегатов так как накладные расходы на их запуск и выполнение выше, чем распараллеливание. Получаем только большую нагрузку и никакого плюса по скорости (даже минус)
## Прошло 1:30 (примерно)
5. **Обед - 30 минут**
6. Рассказывем про async-await по примерам `AsyncSamples` (+- 50 минут). Главное не забыть рассказать, что поток не освобождается сразу при `await`, а продолжает спускаться по вызовам Task через await пока не достигнет перехода в "асинхронность": `Task.Sleep()`, I/O операция асинхронная, явный запуск и ожидание (await) таски в отдельном потоке (или отдельных потоках). Если за кучей await'ов скрывается синхронный тяжелый код который отдает `Task.FromResult` - то поток по факту так и оставался занят
   **Обязательно сказать, что в реальном коде где используется асинхронность, строго запрещено использовать `task.Wait()`, `task.GetAwaiter().GetResult()`, `Task.Wait(task)` и почему нельзя и очень редкие случаи когда можно**
7. Задача: NMAP `async-await` (20 минут сами + 10 на эталон). - *делаем сразу на async-await пропуская перевод на таски без асинхронности. не надо учить плохому*    
   __*нужно сделать эталон*__
## Прошло 1:20 
8. **Перерыв 10 минут**
9. Показ примера с написанием **EchoServer** и **ClusterServer** и асинхронного кода у них.
С помощью `ab.exe` можно и с помощью `bombardier` показываем, как кончаются потоки в пуле, если код на сервере не асинхронный `(Thread.Sleep vs Await Task.Delay)`   
**20 минут**
10. Задача на децентрализованный чат (1:20 сами + 10 эталонное решение)   
***Эталон нужно написать***
11. Формулировка домашнего задания на ClusterClient (10 минут)